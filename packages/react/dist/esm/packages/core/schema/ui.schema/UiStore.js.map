{"version":3,"file":"UiStore.js","sources":["../../../../../../../core/schema/ui.schema/UiStore.ts"],"sourcesContent":["import { cast } from '@binaryoperations/json-forms-internals/cast';\n\nimport {\n  ControlNode,\n  FieldsetNode,\n  UiNodeType,\n  UiSchema,\n} from '../../models/UiSchema';\n\nexport class UiStore {\n  keyMap: Record<string, UiSchema | FieldsetNode> = {};\n  tree: Record<string, string[]> = {};\n\n  constructor() {}\n\n  getChildren(key: string) {\n    return this.tree[key];\n  }\n\n  getNode(key: string) {\n    return this.keyMap[key];\n  }\n\n  getChildNodes(key: string) {\n    return this.getChildren(key).map(this.getNode.bind(this));\n  }\n\n  getNodeType(key: string) {\n    return this.getNode(key).type;\n  }\n\n  isControl(key: string) {\n    return this.getNodeType(key) === UiNodeType.CONTROL;\n  }\n\n  setRoot(key: string) {\n    if (this.isControl(key)) {\n      this.keyMap.root = {\n        id: 'root',\n        type: UiNodeType.ROWS,\n        nodes: [cast<ControlNode>(this.getNode(key))],\n      };\n\n      this.tree.root = [key];\n      return;\n    }\n\n    this.keyMap.root = this.getNode(key);\n    this.tree.root = this.getChildren(key);\n\n    this.keyMap = Object.freeze(this.keyMap);\n    this.tree = Object.freeze(this.tree);\n  }\n\n  deriveNodeSchema(key: string) {\n    if (!this.isControl(key)) return null;\n\n    const node = cast<ControlNode>(this.getNode(key));\n\n    return node.schema;\n  }\n}\n"],"names":["UiStore","__publicField","key","UiNodeType","cast"],"mappings":"4QASO,MAAMA,CAAQ,CAInB,aAAc,CAHdC,EAAA,cAAkD,CAAA,GAClDA,EAAA,YAAiC,CAAA,EAElB,CAEf,YAAYC,EAAa,CAChB,OAAA,KAAK,KAAKA,CAAG,CACtB,CAEA,QAAQA,EAAa,CACZ,OAAA,KAAK,OAAOA,CAAG,CACxB,CAEA,cAAcA,EAAa,CAClB,OAAA,KAAK,YAAYA,CAAG,EAAE,IAAI,KAAK,QAAQ,KAAK,IAAI,CAAC,CAC1D,CAEA,YAAYA,EAAa,CAChB,OAAA,KAAK,QAAQA,CAAG,EAAE,IAC3B,CAEA,UAAUA,EAAa,CACrB,OAAO,KAAK,YAAYA,CAAG,IAAMC,EAAW,OAC9C,CAEA,QAAQD,EAAa,CACf,GAAA,KAAK,UAAUA,CAAG,EAAG,CACvB,KAAK,OAAO,KAAO,CACjB,GAAI,OACJ,KAAMC,EAAW,KACjB,MAAO,CAACC,EAAkB,KAAK,QAAQF,CAAG,CAAC,CAAC,CAAA,EAGzC,KAAA,KAAK,KAAO,CAACA,CAAG,EACrB,MACF,CAEA,KAAK,OAAO,KAAO,KAAK,QAAQA,CAAG,EACnC,KAAK,KAAK,KAAO,KAAK,YAAYA,CAAG,EAErC,KAAK,OAAS,OAAO,OAAO,KAAK,MAAM,EACvC,KAAK,KAAO,OAAO,OAAO,KAAK,IAAI,CACrC,CAEA,iBAAiBA,EAAa,CAC5B,OAAK,KAAK,UAAUA,CAAG,EAEVE,EAAkB,KAAK,QAAQF,CAAG,CAAC,EAEpC,OAJqB,IAKnC,CACF"}